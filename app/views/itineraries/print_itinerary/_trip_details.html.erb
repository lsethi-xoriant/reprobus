<% leg_count = 0 %>
<% currCruise = nil %>
<% cruiseDay = 0 %>


<p class="bigBigtitle4">Confirmation of services</p>
<div class="border"></div>
<div class="clear75"></div>
<p class="bigBigtitle2">Trip Details</p>

<% @itinerary.start_date.upto(@itinerary.get_end_date) do |date|  %>
  <% leg_count = leg_count + 1 %>
  <% dayInfos = ItineraryInfosDay.new %>
  <% dayInfos.set_up_day(@itinerary, date, leg_count) %>
        
  <div class="detailsbox">
  	<p class="headdetails"><%= date %><%= " : Day #{leg_count} - #{dayInfos.country}, #{dayInfos.destination}" %></p>
    
    <% if dayInfos.hotel &&  !dayInfos.hotel.product.remote_url.blank?  %>
      <div class="imgdetails"><img src=<%= dayInfos.hotel.product.get_dropbox_image_link %> alt="" /></div>
    <% elsif dayInfos.cruise && !dayInfos.cruise.product.remote_url.blank? %>  
      <div class="imgdetails"><img src=<%= dayInfos.cruise.product.get_dropbox_image_link %> alt="" /></div>
    <% end %>
    
  	<div class="contdetails">
  	  
        <% if dayInfos.transfer %>
            <%= render partial: 'itineraries/print_itinerary/trip_detail_item', formats: [:html], locals: {preFix: "", info: dayInfos.transfer}  %>
        <% end %>
        
        <% if dayInfos.cruise %>
          <% if currCruise == dayInfos.cruise %>
            <% cruiseDay = cruiseDay + 1 %>
          <% else %>
            <% currCruise = dayInfos.cruise %>
            <% cruiseDay = 1 %>    
          <% end %> 
          <%= render partial: 'itineraries/print_itinerary/trip_detail_item', formats: [:html], locals: {preFix: "Cruise:", info: dayInfos.cruise.product.getCruiseDay(cruiseDay)}  %>
        <% else %>  
          <% currCruise = nil %>
        <% end %>
        
        <%= render partial: 'itineraries/print_itinerary/trip_detail_item', collection: dayInfos.standard_infos , as: :info,  formats: [:html], locals: {prefix: ""}  %>        
        
      <% if dayInfos.hotel %>
          <%= render partial: 'itineraries/print_itinerary/trip_detail_item', formats: [:html], locals: {preFix: "Spend the night at:", info: dayInfos.hotel}  %>
      <% elsif dayInfos.cruise %>
          <%= render partial: 'itineraries/print_itinerary/trip_detail_item', formats: [:html], locals: {preFix: "Stay aboard:", info: dayInfos.cruise}  %>
      <% end %>
      
      </div>
  	<div class="clear"></div>
  </div>

<% end %>

